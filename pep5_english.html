
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAT English Lab - PEPè‹±è¯­äº”å¹´çº§ä¸Šå†Œå¤ä¹ åŠ©æ‰‹</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        
        :root {
            --primary-color: #64B5F6;
            --secondary-color: #FFB74D;
            --success-color: #81C784;
            --danger-color: #E57373;
            --bg-color: #E3F2FD;
            --card-shadow: 0 8px 15px rgba(33, 150, 243, 0.1);
        }
        body {
            background-color: var(--bg-color);
            background-image: radial-gradient(#BBDEFB 1px, transparent 1px);
            background-size: 20px 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding-bottom: 50px;
            color: #455A64;
        }
        .header {
            background: linear-gradient(135deg, #4FC3F7, #64B5F6);
            color: white;
            padding: 5rem 0;
            text-align: center;
            margin-bottom: 2rem;
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.2);
            border-bottom-left-radius: 60px;
            border-bottom-right-radius: 60px;
            position: relative;
            overflow: hidden;
        }
        .core-description {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(5px);
            padding: 20px;
            border-radius: 20px;
            display: inline-block;
            border: 1px solid rgba(255, 255, 255, 0.3);
            max-width: 800px;
        }
        .flashcard {
            height: 140px;
            perspective: 1000px;
            cursor: pointer;
            margin-bottom: 20px;
        }
        .sentence-card {
            height: 180px;
        }
        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            box-shadow: var(--card-shadow);
            border-radius: 20px;
        }
        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }
        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            padding: 15px;
            border-radius: 20px;
            background: white;
            border: 2px solid #E3F2FD;
        }
        .flashcard-back {
            transform: rotateY(180deg);
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            font-size: 1.3rem;
            border: none;
        }
        .flashcard-front {
            background-color: #fff;
            color: #1976D2;
        }
        .sentence-card .flashcard-back {
            font-size: 1.2rem;
        }
        .phonics-badge {
            background-color: #E1F5FE;
            color: #0277BD;
            padding: 8px 20px;
            border-radius: 25px;
            display: inline-block;
            margin-bottom: 10px;
            border: 1px solid #B3E5FC;
        }
        .nav-pills .nav-link {
            border-radius: 25px;
            color: #1976D2;
            margin: 0 5px;
            border: 2px solid transparent;
        }
        .nav-pills .nav-link.active {
            background-color: var(--primary-color);
            box-shadow: 0 4px 10px rgba(33, 150, 243, 0.3);
        }
        .btn-speak {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #E3F2FD;
            border: none;
            font-size: 1.2rem;
            color: var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .btn-speak:hover { background: var(--primary-color); color: white; transform: scale(1.1) rotate(10deg); }
        
        .quiz-section {
            background: white;
            padding: 25px;
            border-radius: 25px;
            box-shadow: var(--card-shadow);
            border: 2px solid #E3F2FD;
        }
        .quiz-item {
            margin-bottom: 25px;
            padding: 20px;
            border-left: 5px solid #BBDEFB;
            background: #F9FCFF;
            border-radius: 0 15px 15px 0;
        }
        .option-btn {
            display: block;
            width: 100%;
            text-align: left;
            margin-bottom: 12px;
            padding: 12px 20px;
            border: 2px solid #E3F2FD;
            border-radius: 12px;
            background: #fff;
            transition: all 0.2s;
            color: #1976D2;
        }
        .option-btn:not(:disabled):hover {
            background: #E3F2FD;
            border-color: var(--primary-color);
            transform: translateX(5px);
        }
        .option-btn.correct {
            background-color: var(--success-color) !important;
            color: white !important;
            border-color: var(--success-color) !important;
        }
        .option-btn.wrong {
            background-color: var(--danger-color) !important;
            color: white !important;
            border-color: var(--danger-color) !important;
        }
        .feedback-pop {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2000;
            font-size: 4rem;
            pointer-events: none;
            display: none;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.1);
        }
        .card {
            border-radius: 25px !important;
            border: 2px solid #E3F2FD !important;
        }
        .writing-card {
            background: #FFF9C4;
            padding: 25px;
            border-radius: 25px;
            border: none;
            border-left: 10px solid var(--secondary-color);
        }
        .writing-tips span {
            background: white;
            padding: 5px 15px;
            border-radius: 15px;
            margin-right: 10px;
            font-size: 0.9rem;
            color: #F57C00;
            border: 1px solid #FFE082;
            display: inline-block;
            margin-bottom: 5px;
        }
        .grammar-spotlight {
            background: #F3E5F5;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            border-left: 8px solid var(--accent-color);
        }
        .grammar-item {
            background: white;
            padding: 10px 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            font-size: 0.95rem;
        }
        .big-idea-banner {
            background: linear-gradient(90deg, #FFF9C4, #FFF176);
            padding: 15px 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 2px dashed #FBC02D;
            display: flex;
            align-items: center;
        }
        .big-idea-icon {
            font-size: 2rem;
            margin-right: 15px;
        }
        .puzzle-box {
            background: rgba(255,255,255,0.5);
            padding: 15px;
            border-radius: 15px;
            min-height: 100px;
        }
        .puzzle-item {
            background: white;
            padding: 8px 15px;
            border-radius: 10px;
            margin-bottom: 8px;
            cursor: pointer;
            border: 1px dashed var(--secondary-color);
            transition: all 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .puzzle-item:hover { background: #FFF3E0; transform: scale(1.02); }
        .puzzle-item.used { opacity: 0.5; cursor: not-allowed; text-decoration: line-through; }
        .spell-input {
            border: 2px solid #E3F2FD;
            border-radius: 10px;
            padding: 5px 10px;
            width: 100%;
            margin-top: 10px;
            font-size: 0.9rem;
            text-align: center;
        }
        .spell-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 5px rgba(33, 150, 243, 0.3);
        }
        .spell-feedback {
            font-size: 0.8rem;
            margin-top: 5px;
            height: 20px;
        }
        .phonics-game {
            background: #F1F8E9;
            border-radius: 15px;
            padding: 15px;
            margin-top: 10px;
            border: 1px solid #C5E1A5;
        }
        .phonics-btn {
            background: white;
            border: 1px solid #AED581;
            padding: 5px 15px;
            border-radius: 20px;
            margin: 5px;
            transition: all 0.2s;
        }
        .phonics-btn:hover {
            background: #DCEDC8;
            transform: translateY(-2px);
        }
        .maruko-mascot {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s;
        }
        /* è¯­éŸ³å¯ç‚¹å‡»é¡¹ */
        .flashcard-back, .sentence-card .flashcard-front, .model-text, .sentence-item {
            cursor: pointer;
        }
        .maruko-mascot:hover {
            transform: scale(1.1) rotate(-5deg);
        }
        .maruko-bubble {
            position: absolute;
            bottom: 80px;
            right: 20px;
            background: white;
            padding: 10px 15px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            font-size: 0.9rem;
            width: 150px;
            display: none;
            border: 2px solid var(--primary-color);
        }
        .maruko-bubble::after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: 20px;
            border-width: 10px 10px 0;
            border-style: solid;
            border-color: white transparent transparent;
        }

        /* é«˜æ•ˆå¤ä¹ åŒºæ ·å¼ */
        .revision-zone {
            background: #E8F5E9;
            border-radius: 25px;
            padding: 20px;
            margin-top: 30px;
            border: 2px solid #C8E6C9;
        }
        .revision-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            color: #2E7D32;
        }
        .revision-header i { font-size: 1.5rem; margin-right: 10px; }

        /* æŒ‘æˆ˜ç«æŠ€åœºæ ·å¼ */
        .arena-card {
            background: #FFF3E0;
            border-radius: 25px;
            padding: 20px;
            margin-top: 30px;
            border: 2px solid #FFE0B2;
        }
        .arena-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            color: #E65100;
        }
        .arena-header i { font-size: 1.5rem; margin-right: 10px; }

        /* ä½œæ–‡å¤©åœ°æ ·å¼ */
        .composition-card {
            background: white;
            border-radius: 25px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--card-shadow);
            border: 2px solid #E3F2FD;
            transition: transform 0.3s;
        }
        .composition-card:hover {
            transform: translateY(-5px);
        }
        .composition-title {
            color: #1976D2;
            font-weight: bold;
            border-bottom: 2px solid #BBDEFB;
            padding-bottom: 10px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .composition-text {
            line-height: 2;
            font-size: 1.1rem;
            color: #455A64;
        }
        .sentence-item {
            cursor: pointer;
            padding: 2px 5px;
            border-radius: 5px;
            transition: background 0.2s;
            display: inline-block;
        }
        .sentence-item:hover {
            background: #E3F2FD;
            color: #1976D2;
        }
        .full-read-btn {
            background: #E3F2FD;
            color: #1976D2;
            border: none;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        .full-read-btn:hover {
            background: var(--primary-color);
            color: white;
        }
        
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 3000;
        }

        .score-badge {
            background: #E3F2FD;
            color: #1976D2;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin-top: 10px;
        }
        
        #student-name-display {
            font-weight: bold;
            color: #1976D2;
            cursor: pointer;
            text-decoration: underline dotted;
        }
        .floating-score {
            position: fixed;
            color: #FF9800;
            font-weight: bold;
            font-size: 1.5rem;
            pointer-events: none;
            z-index: 9999;
            text-shadow: 0 0 10px rgba(255,255,255,0.8);
        }
    </style>
</head>
<body>

<div class="toast-container" id="toast-container"></div>

<div id="feedback-pop" class="feedback-pop animate__animated">ğŸ‰</div>

<div class="header">
    <div class="container">
        <div class="d-flex justify-content-between align-items-start">
            <div>
                <h1 class="animate__animated animate__bounceIn display-4 fw-bold">ğŸŒŸ CAT English Lab</h1>
                <h2 class="animate__animated animate__fadeInDown h3 mt-3">Learn Smart. Speak Strong.</h2>
            </div>
            <button id="btn-unlock-audio" class="btn btn-light btn-sm rounded-pill shadow-sm mt-2" onclick="unlockVoice()">
                ğŸ”Š <span class="d-none d-sm-inline">å¯ç”¨è¯­éŸ³å‘éŸ³</span><span class="d-inline d-sm-none">è¯­éŸ³</span>
            </button>
        </div>
        <p class="lead mt-4 mb-4">
            An English lab where listening leads to confident speaking.<br>
            <span class="small opacity-75">ä¸€ä¸ªç”¨æ–¹æ³•è®­ç»ƒå¬åŠ›ã€ç”¨ç»ƒä¹ æ‰“é€ è¡¨è¾¾åŠ›çš„è‹±è¯­å­¦ä¹ ç©ºé—´</span>
        </p>
        <div class="core-description mt-4 animate__animated animate__fadeInUp animate__delay-1s">
            <p class="mb-1">Designed by Ms Hu (Catherine) for Grade 5 learners.</p>
            <p class="mb-0">Built to help students listen carefully, think clearly, and speak confidently.</p>
        </div>
    </div>
</div>

<div class="container">
    <ul class="nav nav-pills mb-4 justify-content-center bg-white p-2 rounded-pill shadow-sm sticky-top" style="top: 20px; z-index: 1000;" id="unitTabs" role="tablist">
        <li class="nav-item"><button class="nav-link active" id="tab-1" data-bs-toggle="pill" data-bs-target="#unit-1" type="button">Unit 1</button></li><li class="nav-item"><button class="nav-link " id="tab-2" data-bs-toggle="pill" data-bs-target="#unit-2" type="button">Unit 2</button></li><li class="nav-item"><button class="nav-link " id="tab-3" data-bs-toggle="pill" data-bs-target="#unit-3" type="button">Unit 3</button></li><li class="nav-item"><button class="nav-link " id="tab-4" data-bs-toggle="pill" data-bs-target="#unit-4" type="button">Unit 4</button></li><li class="nav-item"><button class="nav-link " id="tab-5" data-bs-toggle="pill" data-bs-target="#unit-5" type="button">Unit 5</button></li><li class="nav-item"><button class="nav-link " id="tab-6" data-bs-toggle="pill" data-bs-target="#unit-6" type="button">Unit 6</button></li>
    </ul>

    <div class="tab-content" id="unitTabContent">
        
        <div class="tab-pane fade show active" id="unit-1" role="tabpanel">
            <div class="row">
                <div class="col-12 mb-5">
                    <h4 class="mb-3 text-secondary">ğŸ”¤ æ ¸å¿ƒè¯æ±‡ <small class="text-muted" style="font-size: 0.8rem">(çœ‹ä¸­æ–‡è¯´è‹±æ–‡ï¼Œç‚¹å‡»å¡ç‰‡éªŒè¯)</small></h4>
                    <div class="row">
                        
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                è€çš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('old')">ğŸ”Š</button>
                            old
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                å¹´è½»çš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('young')">ğŸ”Š</button>
                            young
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ»‘ç¨½çš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('funny')">ğŸ”Š</button>
                            funny
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                å’Œè”¼çš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('kind')">ğŸ”Š</button>
                            kind
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                ä¸¥å‰çš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('strict')">ğŸ”Š</button>
                            strict
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æœ‰ç¤¼è²Œçš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('polite')">ğŸ”Š</button>
                            polite
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                åŠªåŠ›å·¥ä½œçš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('hard-working')">ğŸ”Š</button>
                            hard-working
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æœ‰å¸®åŠ©çš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('helpful')">ğŸ”Š</button>
                            helpful
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                èªæ˜çš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('clever')">ğŸ”Š</button>
                            clever
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                å®³ç¾çš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('shy')">ğŸ”Š</button>
                            shy
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front"><div class="w-100">çŸ¥é“;äº†è§£</div></div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('know')">ğŸ”Š</button>
                            know
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front"><div class="w-100">æœºå™¨äºº</div></div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('robot')">ğŸ”Š</button>
                            robot
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front"><div class="w-100">æœ‰æ—¶;é—´æˆ–</div></div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('sometimes')">ğŸ”Š</button>
                            sometimes
                        </div>
                    </div>
                </div>
            </div>
            
                    </div>
                </div>

                <div class="col-12 mb-5">
                    <h4 class="mb-3 text-secondary">ğŸ—£ï¸ é‡ç‚¹å¥å‹å¡ç‰‡</h4>
                    <div class="row">
                        
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('What\'s he like?')">ğŸ”Š</button>
                            ä»–ä»€ä¹ˆæ ·ï¼Ÿ
                        </div>
                        <div class="flashcard-back">What's he like?</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('He\'s kind.')">ğŸ”Š</button>
                            ä»–å¾ˆå’Œè”¼ã€‚
                        </div>
                        <div class="flashcard-back">He's kind.</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('Is she strict?')">ğŸ”Š</button>
                            å¥¹ä¸¥å‰å—ï¼Ÿ
                        </div>
                        <div class="flashcard-back">Is she strict?</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('Yes, she is.')">ğŸ”Š</button>
                            æ˜¯çš„ï¼Œå¥¹æ˜¯ã€‚
                        </div>
                        <div class="flashcard-back">Yes, she is.</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('No, she isn\'t.')">ğŸ”Š</button>
                            ä¸ï¼Œå¥¹ä¸æ˜¯ã€‚
                        </div>
                        <div class="flashcard-back">No, she isn't.</div>
                    </div>
                </div>
            </div>
            
                    </div>
                </div>

                <div class="col-12">
                    <h4 class="mb-3 text-warning">ğŸ“ ä¸»é¢˜å°ä½œæ–‡ï¼šIntroducing Myself (äº¤å‹)</h4>
                    <div class="card writing-card shadow-sm">
                        <div class="writing-tips mb-3">
                            <strong>ğŸ’¡ å†™ä½œé”¦å›Šï¼š</strong>
                            <span>I'm... (tall/thin)</span><span>I'm... (hard-working)</span><span>I can...</span><span>My favourite food/drink is...</span>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <h6>ğŸ§© å¥å­æ‹¼å›¾ç»ƒä¹  <small class="text-muted">(ç‚¹å‡»å¥å­æŒ‰é¡ºåºç»„æˆä½œæ–‡)</small></h6>
                                <div class="puzzle-pool" id="pool-1">
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 1)">I'm eleven years old. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I am eleven years old.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 1)">How about you? <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('How about you?')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 1)">I'm tall and thin. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I am tall and thin.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 1)">My favourite drink is tea. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('My favourite drink is tea.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 1)">I want to be your friend. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I want to be your friend.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 1)">I'm Jim. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I am Jim.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 1)">I'm hard-working. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I am hard-working.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 1)">My favourite food is dumplings. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('My favourite food is dumplings.')">ğŸ”Š</button></div>
                                </div>
                                <div class="puzzle-box mt-3" id="box-1"></div>
                                <button class="btn btn-sm btn-outline-warning mt-2" onclick="resetPuzzle(1)">ğŸ”„ é‡ç½®æ‹¼å›¾</button>
                            </div>
                            <div class="col-md-6">
                                <h6>ğŸ“– å‚è€ƒèŒƒæ–‡ <button class="btn btn-sm btn-link" onclick="toggleModel(1)">ğŸ‘ï¸ æ˜¾ç¤º/éšè—</button></h6>
                                <div class="model-text p-3 bg-white rounded shadow-sm" id="model-1" style="display:none; line-height: 1.8;">
                                    I want to be your friend. I'm Jim. I'm eleven years old. I'm tall and thin. I'm hard-working. My favourite food is dumplings. My favourite drink is tea. How about you?
                                    <button class="btn-speak btn-sm" style="position:relative; top:0; right:0; display:inline-flex; margin-left:10px;" onclick="event.stopPropagation(); speak('I want to be your friend. I am Jim. I am eleven years old. I am tall and thin. I am hard-working. My favourite food is dumplings. My favourite drink is tea. How about you?')">ğŸ”Š</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-pane fade " id="unit-2" role="tabpanel">
            <div class="row">
                <div class="col-12 mb-5">
                    <h4 class="mb-3 text-secondary">ğŸ”¤ æ ¸å¿ƒè¯æ±‡ <small class="text-muted" style="font-size: 0.8rem">(çœ‹ä¸­æ–‡è¯´è‹±æ–‡ï¼Œç‚¹å‡»å¡ç‰‡éªŒè¯)</small></h4>
                    <div class="row">
                        <div class="col-6 col-md-3">
                            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front"><div class="w-100">æ˜ŸæœŸä¸€</div></div>
                                    <div class="flashcard-back">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('Monday')">ğŸ”Š</button>
                                        Monday
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front"><div class="w-100">æ˜ŸæœŸäºŒ</div></div>
                                    <div class="flashcard-back">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('Tuesday')">ğŸ”Š</button>
                                        Tuesday
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front"><div class="w-100">æ˜ŸæœŸä¸‰</div></div>
                                    <div class="flashcard-back">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('Wednesday')">ğŸ”Š</button>
                                        Wednesday
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front"><div class="w-100">æ˜ŸæœŸå››</div></div>
                                    <div class="flashcard-back">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('Thursday')">ğŸ”Š</button>
                                        Thursday
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front"><div class="w-100">æ˜ŸæœŸäº”</div></div>
                                    <div class="flashcard-back">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('Friday')">ğŸ”Š</button>
                                        Friday
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front"><div class="w-100">æ˜ŸæœŸå…­</div></div>
                                    <div class="flashcard-back">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('Saturday')">ğŸ”Š</button>
                                        Saturday
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front"><div class="w-100">æ˜ŸæœŸæ—¥</div></div>
                                    <div class="flashcard-back">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('Sunday')">ğŸ”Š</button>
                                        Sunday
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front"><div class="w-100">å‘¨æœ«</div></div>
                                    <div class="flashcard-back">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('weekend')">ğŸ”Š</button>
                                        weekend
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front"><div class="w-100">æ´—è¡£æœ</div></div>
                                    <div class="flashcard-back">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('wash my clothes')">ğŸ”Š</button>
                                        wash my clothes
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front"><div class="w-100">çœ‹ç”µè§†</div></div>
                                    <div class="flashcard-back">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('watch TV')">ğŸ”Š</button>
                                        watch TV
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front"><div class="w-100">åšä½œä¸š</div></div>
                                    <div class="flashcard-back">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('do homework')">ğŸ”Š</button>
                                        do homework
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front"><div class="w-100">çœ‹ä¹¦</div></div>
                                    <div class="flashcard-back">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('read books')">ğŸ”Š</button>
                                        read books
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="flashcard" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front"><div class="w-100">è¸¢è¶³çƒ</div></div>
                                    <div class="flashcard-back">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('play football')">ğŸ”Š</button>
                                        play football
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-12 mb-5">
                    <h4 class="mb-3 text-secondary">ğŸ—£ï¸ é‡ç‚¹å¥å‹å¡ç‰‡</h4>
                    <div class="row">
                        <div class="col-12 col-md-6">
                            <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('What do you have on Thursdays?')">ğŸ”Š</button>
                                        ä½ æ˜ŸæœŸå››æœ‰ä»€ä¹ˆè¯¾ï¼Ÿ
                                    </div>
                                    <div class="flashcard-back">What do you have on Thursdays?</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('I have maths, English and music.')">ğŸ”Š</button>
                                        æˆ‘æœ‰æ•°å­¦ã€è‹±è¯­å’ŒéŸ³ä¹è¯¾ã€‚
                                    </div>
                                    <div class="flashcard-back">I have maths, English and music.</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                                <div class="flashcard-inner">
                                    <div class="flashcard-front">
                                        <button class="btn-speak" onclick="event.stopPropagation(); speak('Do you often read books in this park?')">ğŸ”Š</button>
                                        ä½ ç»å¸¸åœ¨è¿™ä¸ªå…¬å›­çœ‹ä¹¦å—ï¼Ÿ
                                    </div>
                                    <div class="flashcard-back">Do you often read books in this park?</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-12">
                    <h4 class="mb-3 text-warning">ğŸ“ ä¸»é¢˜å°ä½œæ–‡ï¼šMy weekend (å‘¨æœ«æ´»åŠ¨)</h4>
                    <div class="card writing-card shadow-sm">
                        <div class="writing-tips mb-3">
                            <strong>ğŸ’¡ å†™ä½œé”¦å›Šï¼š</strong>
                            <span>On Saturdays...</span><span>On Sundays...</span><span>I often...</span><span>I usually...</span><span>busy/happy</span>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <h6>ğŸ§© å¥å­æ‹¼å›¾ç»ƒä¹  <small class="text-muted">(ç‚¹å‡»å¥å­æŒ‰é¡ºåºç»„æˆä½œæ–‡)</small></h6>
                                <div class="puzzle-pool" id="pool-2">
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 2)">I'm always busy on the weekend. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I am always busy on the weekend.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 2)">On Saturdays, I often do my homework in the morning. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('On Saturdays, I often do my homework in the morning.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 2)">In the afternoon, I often play football with my friends. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('In the afternoon, I often play football with my friends.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 2)">On Sundays, I usually visit my grandparents. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('On Sundays, I usually visit my grandparents.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 2)">I often watch TV with my parents in the afternoon. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I often watch TV with my parents in the afternoon.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 2)">I like my weekends. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I like my weekends.')">ğŸ”Š</button></div>
                                </div>
                                <div class="puzzle-box mt-3" id="box-2"></div>
                                <button class="btn btn-sm btn-outline-warning mt-2" onclick="resetPuzzle(2)">ğŸ”„ é‡ç½®æ‹¼å›¾</button>
                            </div>
                            <div class="col-md-6">
                                <h6>ğŸ“– å‚è€ƒèŒƒæ–‡ <button class="btn btn-sm btn-link" onclick="toggleModel(2)">ğŸ‘ï¸ æ˜¾ç¤º/éšè—</button></h6>
                                <div class="model-text p-3 bg-white rounded shadow-sm" id="model-2" style="display:none; line-height: 1.8;">
                                    I'm always busy on the weekend. On Saturdays, I often do my homework in the morning. In the afternoon, I often play football with my friends in the park. On Sundays, I usually visit my grandparents in the morning and watch TV with my parents in the afternoon. I like my weekends.
                                    <button class="btn-speak btn-sm" style="position:relative; top:0; right:0; display:inline-flex; margin-left:10px;" onclick="event.stopPropagation(); speak('I am always busy on the weekend. On Saturdays, I often do my homework in the morning. In the afternoon, I often play football with my friends in the park. On Sundays, I usually visit my grandparents in the morning and watch TV with my parents in the afternoon. I like my weekends.')">ğŸ”Š</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-pane fade " id="unit-3" role="tabpanel">
            <div class="row">
                <div class="col-12 mb-5">
                    <h4 class="mb-3 text-secondary">ğŸ”¤ æ ¸å¿ƒè¯æ±‡ <small class="text-muted" style="font-size: 0.8rem">(çœ‹ä¸­æ–‡è¯´è‹±æ–‡ï¼Œç‚¹å‡»å¡ç‰‡éªŒè¯)</small></h4>
                    <div class="row">
                        
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                ä¸‰æ˜æ²»
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('sandwich')">ğŸ”Š</button>
                            sandwich
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ²™æ‹‰
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('salad')">ğŸ”Š</button>
                            salad
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ±‰å ¡åŒ…
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('hamburger')">ğŸ”Š</button>
                            hamburger
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                å†°æ·‡æ·‹
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('ice cream')">ğŸ”Š</button>
                            ice cream
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ–°é²œçš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('fresh')">ğŸ”Š</button>
                            fresh
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                å¥åº·çš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('healthy')">ğŸ”Š</button>
                            healthy
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                ç¾å‘³çš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('delicious')">ğŸ”Š</button>
                            delicious
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                ç”œçš„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('sweet')">ğŸ”Š</button>
                            sweet
                        </div>
                    </div>
                </div>
            </div>
            
                    </div>
                </div>

                <div class="col-12 mb-5">
                    <h4 class="mb-3 text-secondary">ğŸ—£ï¸ é‡ç‚¹å¥å‹å¡ç‰‡</h4>
                    <div class="row">
                        
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('What would you like to eat?')">ğŸ”Š</button>
                            ä½ æƒ³åƒä»€ä¹ˆï¼Ÿ
                        </div>
                        <div class="flashcard-back">What would you like to eat?</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('A sandwich, please.')">ğŸ”Š</button>
                            è¯·ç»™æˆ‘ä¸€ä¸ªä¸‰æ˜æ²»ã€‚
                        </div>
                        <div class="flashcard-back">A sandwich, please.</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('What would you like to drink?')">ğŸ”Š</button>
                            ä½ æƒ³å–ä»€ä¹ˆï¼Ÿ
                        </div>
                        <div class="flashcard-back">What would you like to drink?</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('I\'d like some water.')">ğŸ”Š</button>
                            æˆ‘æƒ³è¦ç‚¹æ°´ã€‚
                        </div>
                        <div class="flashcard-back">I'd like some water.</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('What\'s your favourite food?')">ğŸ”Š</button>
                            ä½ æœ€å–œæ¬¢çš„é£Ÿç‰©æ˜¯ä»€ä¹ˆï¼Ÿ
                        </div>
                        <div class="flashcard-back">What's your favourite food?</div>
                    </div>
                </div>
            </div>
            
                    </div>
                </div>

                <div class="col-12">
                    <h4 class="mb-3 text-warning">ğŸ“ ä¸»é¢˜å°ä½œæ–‡ï¼šMy Favourite Food</h4>
                    <div class="card writing-card shadow-sm">
                        <div class="writing-tips mb-3">
                            <strong>ğŸ’¡ å†™ä½œé”¦å›Šï¼š</strong>
                            <span>What's your favourite...?</span><span>I like...</span><span>It's/They are...</span><span>healthy/delicious</span><span>sweet/fresh</span>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <h6>ğŸ§© å¥å­æ‹¼å›¾ç»ƒä¹  <small class="text-muted">(ç‚¹å‡»å¥å­æŒ‰é¡ºåºç»„æˆä½œæ–‡)</small></h6>
                                <div class="puzzle-pool" id="pool-3">
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 3)">I like salad, too. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I like salad, too.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 3)">I don't like beef but chicken is OK. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I do not like beef but chicken is OK.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 3)">I like grapes best. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I like grapes best.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 3)">My favourite food is sandwich. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('My favourite food is sandwich.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 3)">It is very fresh. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('It is very fresh.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 3)">What's your favourite food and drink? <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('What is your favourite food and drink?')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 3)">It's healthy and delicious. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('It is healthy and delicious.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 3)">They are sweet and purple. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('They are sweet and purple.')">ğŸ”Š</button></div>
                                </div>
                                <div class="puzzle-box mt-3" id="box-3"></div>
                                <button class="btn btn-sm btn-outline-warning mt-2" onclick="resetPuzzle(3)">ğŸ”„ é‡ç½®æ‹¼å›¾</button>
                            </div>
                            <div class="col-md-6">
                                <h6>ğŸ“– å‚è€ƒèŒƒæ–‡ <button class="btn btn-sm btn-link" onclick="toggleModel(3)">ğŸ‘ï¸ æ˜¾ç¤º/éšè—</button></h6>
                                <div class="model-text p-3 bg-white rounded shadow-sm" id="model-3" style="display:none; line-height: 1.8;">
                                    My favourite food is sandwich. It's healthy and delicious. I like salad, too. It is very fresh. I don't like beef but chicken is OK. I like grapes best. They are sweet and purple. What's your favourite food and drink?
                                    <button class="btn-speak btn-sm" style="position:relative; top:0; right:0; display:inline-flex; margin-left:10px;" onclick="event.stopPropagation(); speak('My favourite food is sandwich. It\'s healthy and delicious. I like salad, too. It is very fresh. I don\'t like beef but chicken is OK. I like grapes best. They are sweet and purple. What\'s your favourite food and drink?')">ğŸ”Š</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-pane fade " id="unit-4" role="tabpanel">
            <div class="row">
                <div class="col-12 mb-5">
                    <h4 class="mb-3 text-secondary">ğŸ”¤ æ ¸å¿ƒè¯æ±‡ <small class="text-muted" style="font-size: 0.8rem">(çœ‹ä¸­æ–‡è¯´è‹±æ–‡ï¼Œç‚¹å‡»å¡ç‰‡éªŒè¯)</small></h4>
                    <div class="row">
                        
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                è·³èˆ
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('dance')">ğŸ”Š</button>
                            dance
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                å”±æ­Œ
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('sing')">ğŸ”Š</button>
                            sing
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                ç»ƒæ­¦æœ¯
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('do kung fu')">ğŸ”Š</button>
                            do kung fu
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                ç”»æ¼«ç”»
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('draw cartoons')">ğŸ”Š</button>
                            draw cartoons
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ¸¸æ³³
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('swim')">ğŸ”Š</button>
                            swim
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                è¯´è‹±è¯­
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('speak English')">ğŸ”Š</button>
                            speak English
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ‰“ç¯®çƒ
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('play basketball')">ğŸ”Š</button>
                            play basketball
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ‰“ä¹’ä¹“çƒ
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('play ping-pong')">ğŸ”Š</button>
                            play ping-pong
                        </div>
                    </div>
                </div>
            </div>
            
                    </div>
                </div>

                <div class="col-12 mb-5">
                    <h4 class="mb-3 text-secondary">ğŸ—£ï¸ é‡ç‚¹å¥å‹å¡ç‰‡</h4>
                    <div class="row">
                        
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('What can you do?')">ğŸ”Š</button>
                            ä½ ä¼šåšä»€ä¹ˆï¼Ÿ
                        </div>
                        <div class="flashcard-back">What can you do?</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('I can draw cartoons.')">ğŸ”Š</button>
                            æˆ‘ä¼šç”»æ¼«ç”»ã€‚
                        </div>
                        <div class="flashcard-back">I can draw cartoons.</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('Can you do any kung fu?')">ğŸ”Š</button>
                            ä½ ä¼šç»ƒæ­¦æœ¯å—ï¼Ÿ
                        </div>
                        <div class="flashcard-back">Can you do any kung fu?</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('Yes, I can.')">ğŸ”Š</button>
                            æ˜¯çš„ï¼Œæˆ‘ä¼šã€‚
                        </div>
                        <div class="flashcard-back">Yes, I can.</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('No, I can\'t.')">ğŸ”Š</button>
                            ä¸ï¼Œæˆ‘ä¸ä¼šã€‚
                        </div>
                        <div class="flashcard-back">No, I can't.</div>
                    </div>
                </div>
            </div>
            
                    </div>
                </div>

                <div class="col-12">
                    <h4 class="mb-3 text-warning">ğŸ“ ä¸»é¢˜å°ä½œæ–‡ï¼šWhat I Can Do</h4>
                    <div class="card writing-card shadow-sm">
                        <div class="writing-tips mb-3">
                            <strong>ğŸ’¡ å†™ä½œé”¦å›Šï¼š</strong>
                            <span>I can...</span><span>Can you...?</span><span>Yes, I can.</span><span>helpful/great</span><span>play the pipa/do kung fu</span>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <h6>ğŸ§© å¥å­æ‹¼å›¾ç»ƒä¹  <small class="text-muted">(ç‚¹å‡»å¥å­æŒ‰é¡ºåºç»„æˆä½œæ–‡)</small></h6>
                                <div class="puzzle-pool" id="pool-4">
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 4)">I can do some kung fu, too. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I can do some kung fu, too.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 4)">I can clean the room and wash my clothes. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I can clean the room and wash my clothes.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 4)">I am helpful at home. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I am helpful at home.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 4)">I can speak English and Chinese. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I can speak English and Chinese.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 4)">I can cook delicious food for my parents. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I can cook delicious food for my parents.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 4)">But I can't swim. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('But I cannot swim.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 4)">I want to be great. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I want to be great.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 4)">Can you help me? <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('Can you help me?')">ğŸ”Š</button></div>
                                </div>
                                <div class="puzzle-box mt-3" id="box-4"></div>
                                <button class="btn btn-sm btn-outline-warning mt-2" onclick="resetPuzzle(4)">ğŸ”„ é‡ç½®æ‹¼å›¾</button>
                            </div>
                            <div class="col-md-6">
                                <h6>ğŸ“– å‚è€ƒèŒƒæ–‡ <button class="btn btn-sm btn-link" onclick="toggleModel(4)">ğŸ‘ï¸ æ˜¾ç¤º/éšè—</button></h6>
                                <div class="model-text p-3 bg-white rounded shadow-sm" id="model-4" style="display:none; line-height: 1.8;">
                                    I am helpful at home. I can clean the room and wash my clothes. I can cook delicious food for my parents. I can speak English and Chinese. I can do some kung fu, too. But I can't swim. Can you help me? I want to be great.
                                    <button class="btn-speak btn-sm" style="position:relative; top:0; right:0; display:inline-flex; margin-left:10px;" onclick="event.stopPropagation(); speak('I am helpful at home. I can clean the room and wash my clothes. I can cook delicious food for my parents. I can speak English and Chinese. I can do some kung fu, too. But I can\'t swim. Can you help me? I want to be great.')">ğŸ”Š</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-pane fade " id="unit-5" role="tabpanel">
            <div class="row">
                <div class="col-12 mb-5">
                    <h4 class="mb-3 text-secondary">ğŸ”¤ æ ¸å¿ƒè¯æ±‡ <small class="text-muted" style="font-size: 0.8rem">(çœ‹ä¸­æ–‡è¯´è‹±æ–‡ï¼Œç‚¹å‡»å¡ç‰‡éªŒè¯)</small></h4>
                    <div class="row">
                        
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ—¶é’Ÿ
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('clock')">ğŸ”Š</button>
                            clock
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ¤ç‰©
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('plant')">ğŸ”Š</button>
                            plant
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ°´ç“¶
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('water bottle')">ğŸ”Š</button>
                            water bottle
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                ç…§ç‰‡
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('photo')">ğŸ”Š</button>
                            photo
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                åœ¨...å‰é¢
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('in front of')">ğŸ”Š</button>
                            in front of
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                åœ¨...ä¸­é—´
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('between')">ğŸ”Š</button>
                            between
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                åœ¨...ä¸Šé¢
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('above')">ğŸ”Š</button>
                            above
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                åœ¨...æ—è¾¹
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('beside')">ğŸ”Š</button>
                            beside
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                åœ¨...åé¢
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('behind')">ğŸ”Š</button>
                            behind
                        </div>
                    </div>
                </div>
            </div>
            
                    </div>
                </div>

                <div class="col-12 mb-5">
                    <h4 class="mb-3 text-secondary">ğŸ—£ï¸ é‡ç‚¹å¥å‹å¡ç‰‡</h4>
                    <div class="row">
                        
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('There is a big bed.')">ğŸ”Š</button>
                            æœ‰ä¸€å¼ å¤§åºŠã€‚
                        </div>
                        <div class="flashcard-back">There is a big bed.</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('There are so many pictures here.')">ğŸ”Š</button>
                            è¿™é‡Œæœ‰å¥½å¤šç…§ç‰‡ã€‚
                        </div>
                        <div class="flashcard-back">There are so many pictures here.</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('Where is the ball?')">ğŸ”Š</button>
                            çƒåœ¨å“ªé‡Œï¼Ÿ
                        </div>
                        <div class="flashcard-back">Where is the ball?</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('It\'s in front of the dog.')">ğŸ”Š</button>
                            å®ƒåœ¨ç‹—çš„å‰é¢ã€‚
                        </div>
                        <div class="flashcard-back">It's in front of the dog.</div>
                    </div>
                </div>
            </div>
            
                    </div>
                </div>



                <div class="col-12">
                    <h4 class="mb-3 text-warning">ğŸ“ ä¸»é¢˜å°ä½œæ–‡ï¼šMy Room</h4>
                    <div class="card writing-card shadow-sm">
                        <div class="writing-tips mb-3">
                            <strong>ğŸ’¡ å†™ä½œé”¦å›Šï¼š</strong>
                            <span>There is/are...</span><span>in front of/beside/between</span><span>clock/plant/photo</span><span>tidy/nice</span>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <h6>ğŸ§© å¥å­æ‹¼å›¾ç»ƒä¹  <small class="text-muted">(ç‚¹å‡»å¥å­æŒ‰é¡ºåºç»„æˆä½œæ–‡)</small></h6>
                                <div class="puzzle-pool" id="pool-5">
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 5)">There are two plants on the desk. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('There are two plants on the desk.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 5)">I like my room very much. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('I like my room very much.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 5)">There is a big bed. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('There is a big bed.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 5)">This is my room. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('This is my room.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 5)">My computer is on the desk, too. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('My computer is on the desk, too.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 5)">There is a clock above the bed. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('There is a clock above the bed.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 5)">It is small but very nice. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('It is small but very nice.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 5)">Beside the bed, there is a desk. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('Beside the bed, there is a desk.')">ğŸ”Š</button></div>
                                </div>
                                <div class="puzzle-box mt-3" id="box-5"></div>
                                <button class="btn btn-sm btn-outline-warning mt-2" onclick="resetPuzzle(5)">ğŸ”„ é‡ç½®æ‹¼å›¾</button>
                            </div>
                            <div class="col-md-6">
                                <h6>ğŸ“– å‚è€ƒèŒƒæ–‡ <button class="btn btn-sm btn-link" onclick="toggleModel(5)">ğŸ‘ï¸ æ˜¾ç¤º/éšè—</button></h6>
                                <div class="model-text p-3 bg-white rounded shadow-sm" id="model-5" style="display:none; line-height: 1.8;">
                                    This is my room. It is small but very nice. There is a big bed. There is a clock above the bed. Beside the bed, there is a desk. There are two plants on the desk. My computer is on the desk, too. I like my room very much.
                                    <button class="btn-speak btn-sm" style="position:relative; top:0; right:0; display:inline-flex; margin-left:10px;" onclick="event.stopPropagation(); speak('This is my room. It is small but very nice. There is a big bed. There is a clock above the bed. Beside the bed, there is a desk. There are two plants on the desk. My computer is on the desk, too. I like my room very much.')">ğŸ”Š</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-pane fade " id="unit-6" role="tabpanel">
            <div class="row">
                <div class="col-12 mb-5">
                    <h4 class="mb-3 text-secondary">ğŸ”¤ æ ¸å¿ƒè¯æ±‡ <small class="text-muted" style="font-size: 0.8rem">(çœ‹ä¸­æ–‡è¯´è‹±æ–‡ï¼Œç‚¹å‡»å¡ç‰‡éªŒè¯)</small></h4>
                    <div class="row">
                        
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ£®æ—
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('forest')">ğŸ”Š</button>
                            forest
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ²³æµ
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('river')">ğŸ”Š</button>
                            river
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ¹–æ³Š
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('lake')">ğŸ”Š</button>
                            lake
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                é«˜å±±
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('mountain')">ğŸ”Š</button>
                            mountain
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                å°å±±
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('hill')">ğŸ”Š</button>
                            hill
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ¡¥
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('bridge')">ğŸ”Š</button>
                            bridge
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                å»ºç­‘ç‰©
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('building')">ğŸ”Š</button>
                            building
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-6 col-md-3">
                <div class="flashcard" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <div class="w-100">
                                æ‘åº„
                            </div>
                        </div>
                        <div class="flashcard-back">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('village')">ğŸ”Š</button>
                            village
                        </div>
                    </div>
                </div>
            </div>
            
                    </div>
                </div>

                <div class="col-12 mb-5">
                    <h4 class="mb-3 text-secondary">ğŸ—£ï¸ é‡ç‚¹å¥å‹å¡ç‰‡</h4>
                    <div class="row">
                        
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('Is there a river in the forest?')">ğŸ”Š</button>
                            æ£®æ—é‡Œæœ‰æ²³å—ï¼Ÿ
                        </div>
                        <div class="flashcard-back">Is there a river in the forest?</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('Yes, there is.')">ğŸ”Š</button>
                            æ˜¯çš„ï¼Œæœ‰ã€‚
                        </div>
                        <div class="flashcard-back">Yes, there is.</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('No, there isn\'t.')">ğŸ”Š</button>
                            ä¸ï¼Œæ²¡æœ‰ã€‚
                        </div>
                        <div class="flashcard-back">No, there isn't.</div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-md-6">
                <div class="flashcard sentence-card" onclick="this.classList.toggle('flipped')">
                    <div class="flashcard-inner">
                        <div class="flashcard-front">
                            <button class="btn-speak" onclick="event.stopPropagation(); speak('Are there any tall buildings in the nature park?')">ğŸ”Š</button>
                            è‡ªç„¶å…¬å›­é‡Œæœ‰é«˜æ¥¼å—ï¼Ÿ
                        </div>
                        <div class="flashcard-back">Are there any tall buildings in the nature park?</div>
                    </div>
                </div>
            </div>
            
                    </div>
                </div>

                <div class="col-12">
                    <h4 class="mb-3 text-warning">ğŸ“ ä¸»é¢˜å°ä½œæ–‡ï¼šIn a Nature Park</h4>
                    <div class="card writing-card shadow-sm">
                        <div class="writing-tips mb-3">
                            <strong>ğŸ’¡ å†™ä½œé”¦å›Šï¼š</strong>
                            <span>There is/are...</span><span>Where is...</span><span>Is there...</span><span>Are there any...</span><span>beautiful/clean</span>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <h6>ğŸ§© å¥å­æ‹¼å›¾ç»ƒä¹  <small class="text-muted">(ç‚¹å‡»å¥å­æŒ‰é¡ºåºç»„æˆä½œæ–‡)</small></h6>
                                <div class="puzzle-pool" id="pool-6">
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 6)">There is a high mountain near the lake. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('There is a high mountain near the lake.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 6)">There is a lake in the park. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('There is a lake in the park.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 6)">There are many trees in the park. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('There are many trees in the park.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 6)">The water is clean. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('The water is clean.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 6)">There are many ducks on the lake. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('There are many ducks on the lake.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 6)">Do you like my nature park? <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('Do you like my nature park?')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 6)">This is my nature park. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('This is my nature park.')">ğŸ”Š</button></div>
                                    <div class="puzzle-item" onclick="addToPuzzle(this, 6)">It is so big and beautiful. <button class="btn-speak btn-sm" onclick="event.stopPropagation(); speak('It is so big and beautiful.')">ğŸ”Š</button></div>
                                </div>
                                <div class="puzzle-box mt-3" id="box-6"></div>
                                <button class="btn btn-sm btn-outline-warning mt-2" onclick="resetPuzzle(6)">ğŸ”„ é‡ç½®æ‹¼å›¾</button>
                            </div>
                            <div class="col-md-6">
                                <h6>ğŸ“– å‚è€ƒèŒƒæ–‡ <button class="btn btn-sm btn-link" onclick="toggleModel(6)">ğŸ‘ï¸ æ˜¾ç¤º/éšè—</button></h6>
                                <div class="model-text p-3 bg-white rounded shadow-sm" id="model-6" style="display:none; line-height: 1.8;">
                                    Look! This is my nature park. It is so big and beautiful. There is a lake in the park. The water is clean. There are many ducks on the lake. There is a high mountain near the lake. There are many trees in the park. Do you like my nature park?
                                    <button class="btn-speak btn-sm" style="position:relative; top:0; right:0; display:inline-flex; margin-left:10px;" onclick="event.stopPropagation(); speak('Look! This is my nature park. It is so big and beautiful. There is a lake in the park. The water is clean. There are many ducks on the lake. There is a high mountain near the lake. There are many trees in the park. Do you like my nature park?')">ğŸ”Š</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<footer class="text-center mt-5 mb-4 text-muted">
    <p>Â© 2026 Catherineçš„è‹±è¯­è¯¾å ‚</p>
    <p class="small opacity-75">Powered by Catherine Hu & SanMei Assistant</p>
</footer>

<!-- éŸ³æ•ˆèµ„æº -->
<audio id="audio-correct" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"></audio>
<audio id="audio-clapping" src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3"></audio>

<!-- è¯æ±‡æµ‹è¯•æ¨¡æ€æ¡† -->
<div class="modal fade" id="vocabModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 border-0 shadow-lg">
            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title fw-bold text-success">ğŸ† è¯æ±‡è¾¾äººæŒ‘æˆ˜</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body py-4" id="vocabTestBody">
                <!-- æµ‹è¯•å†…å®¹å°†ç”± JavaScript åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>
</div>

<!-- å§“åè®¾ç½®æ¨¡æ€æ¡† -->
<div class="modal fade" id="nameModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 border-0 shadow-lg">
            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title fw-bold text-primary">ğŸ‘‹ æ¬¢è¿åŠ å…¥è‹±è¯­æŒ‘æˆ˜ï¼</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body py-4">
                <p class="text-muted mb-4">ç»™è‡ªå·±èµ·ä¸€ä¸ªå“äº®çš„è‹±æ–‡åæˆ–ä¸­æ–‡åå§ï¼Œä½ çš„æˆç»©å°†è®°å½•åœ¨è£èª‰æ¦œä¸Šï¼</p>
                <div class="form-floating mb-3">
                    <input type="text" class="form-control rounded-3" id="studentNameInput" placeholder="ä¾‹å¦‚: Super Tom">
                    <label for="studentNameInput">è¾“å…¥ä½ çš„åå­—</label>
                </div>
            </div>
            <div class="modal-footer border-0 pt-0">
                <button type="button" class="btn btn-primary w-100 py-2 rounded-3 fw-bold" onclick="saveStudentName()">å¼€å§‹æŒ‘æˆ˜ï¼ğŸš€</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script>
    const unitProgress = {};
    const encouragingWords = ["å¤ªæ£’äº†ï¼", "çœŸèªæ˜ï¼", "ä½ å¤ªç‰›äº†ï¼", "ç»§ç»­åŠ æ²¹ï¼", "å®Œç¾ï¼", "è‹±è¯­å°è¾¾äººï¼"];
    
    // æ’è¡Œæ¦œç›¸å…³é€»è¾‘
    let currentUser = localStorage.getItem('pep5_current_user') || 'æœªå‘½åå­¦ç”Ÿ';
    let currentScore = 0;
    
    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
        updateUserDisplay();
        loadLeaderboard();
        
        // ç›‘å¬æ ‡ç­¾åˆ‡æ¢
        const rankTab = document.getElementById('tab-rank');
        if (rankTab) {
            rankTab.addEventListener('shown.bs.tab', () => {
                loadLeaderboard();
            });
        }
        
        // æ£€æŸ¥æ˜¯å¦æœ‰å­˜å‚¨çš„å½“æ¬¡åˆ†æ•°ï¼ˆå¯é€‰ï¼Œç›®å‰æ¯æ¬¡åˆ·æ–°å½’é›¶æˆ–ä»localStorageè¯»å–ï¼‰
        // è¿™é‡Œè®¾è®¡ä¸ºå•æ¬¡ä¼šè¯ç´¯ç§¯ï¼Œåˆ·æ–°é¡µé¢é‡ç½®å½“æ¬¡åˆ†æ•°ï¼Œä½†æ’è¡Œæ¦œè®°å½•å†å²æœ€é«˜
    });

    function updateUserDisplay() {
        const display = document.getElementById('student-name-display');
        if (display) display.innerText = currentUser;
    }

    function changeStudentName() {
        const modal = new bootstrap.Modal(document.getElementById('nameModal'));
        document.getElementById('studentNameInput').value = currentUser === 'æœªå‘½åå­¦ç”Ÿ' ? '' : currentUser;
        modal.show();
    }

    function saveStudentName() {
        const input = document.getElementById('studentNameInput');
        const newName = input.value.trim();
        if (newName) {
            currentUser = newName;
            localStorage.setItem('pep5_current_user', currentUser);
            updateUserDisplay();
            // åˆ‡æ¢ç”¨æˆ·åé‡ç½®å½“å‰ä¸´æ—¶å¾—åˆ†
            currentScore = 0;
            updateScoreDisplay();
            
            const modal = bootstrap.Modal.getInstance(document.getElementById('nameModal'));
            modal.hide();
            
            showToast(`æ¬¢è¿ä½ ï¼Œ${currentUser}ï¼å¼€å§‹æŒ‘æˆ˜å§ï¼ğŸš€`, "success");
        } else {
            showToast("è¯·è¾“å…¥ä½ çš„åå­—å“¦ï¼", "warning");
        }
    }
    
    function addScore(points, event) {
        if (currentUser === 'æœªå‘½åå­¦ç”Ÿ') {
            changeStudentName();
            return;
        }
        
        currentScore += points;
        updateScoreDisplay();
        
        // å¢åŠ å¾—åˆ†åŠ¨ç”»æ•ˆæœ
        const scoreBadge = document.querySelector('.score-badge');
        if (scoreBadge) {
            scoreBadge.classList.add('animate__animated', 'animate__pulse');
            setTimeout(() => scoreBadge.classList.remove('animate__animated', 'animate__pulse'), 1000);
        }

        // æµ®åŠ¨å¾—åˆ†åŠ¨ç”»
        const evt = event || window.event;
        if (evt && evt.clientX && evt.clientY) {
            createFloatingScore(points, evt.clientX, evt.clientY);
        } else if (scoreBadge) {
            const badgeRect = scoreBadge.getBoundingClientRect();
            createFloatingScore(points, badgeRect.left, badgeRect.top);
        }
        
        // æ›´æ–°æ’è¡Œæ¦œæ•°æ® (ç´¯åŠ æ¨¡å¼)
        updateLeaderboard(currentUser, points);
    }

    function createFloatingScore(points, x, y) {
        const el = document.createElement('div');
        el.className = 'floating-score animate__animated animate__fadeOutUp';
        el.innerText = '+' + points;
        el.style.left = x + 'px';
        el.style.top = (y - 20) + 'px';
        document.body.appendChild(el);
        
        setTimeout(() => {
            el.remove();
        }, 1000);
    }
    
    function updateScoreDisplay() {
        const scoreEl = document.getElementById('current-session-score');
        if (scoreEl) scoreEl.innerText = currentScore;
    }

    // --- è¯æ±‡æµ‹è¯•åŠŸèƒ½ ---
    let vocabTestState = {
        currentUnit: 0,
        questions: [],
        currentIndex: 0,
        score: 0
    };

    function startVocabTest(unitId, vocabList) {
        vocabTestState.currentUnit = unitId;
        const targetCount = 10;
        
        // å¦‚æœè¯æ±‡é‡ä¸è¶³ 10ï¼Œåˆ™å¾ªç¯è¡¥å……ç›´åˆ°è¾¾åˆ° 10 ä¸ª
        let testList = [...vocabList];
        while (testList.length < targetCount) {
            testList = testList.concat(vocabList);
        }
        
        // ä»è¡¥å……åçš„è¯æ±‡è¡¨ä¸­éšæœºé€‰å– 10 ä¸ªå•è¯è¿›è¡Œæµ‹è¯•
        const shuffled = shuffleArray(testList).slice(0, targetCount);
        
        vocabTestState.questions = shuffled.map(wordObj => {
            // ç”Ÿæˆå¹²æ‰°é¡¹ (ä»åŸå§‹è¯æ±‡è¡¨ä¸­é€‰å–ï¼Œé¿å…é€‰é¡¹é‡å¤)
            const distractors = vocabList
                .filter(w => w.en !== wordObj.en)
                .sort(() => 0.5 - Math.random())
                .slice(0, 2);
            
            const options = shuffleArray([wordObj.en, ...distractors.map(d => d.en)]);
            return {
                cn: wordObj.cn,
                en: wordObj.en,
                options: options
            };
        });
        vocabTestState.currentIndex = 0;
        vocabTestState.score = 0;

        const modal = new bootstrap.Modal(document.getElementById('vocabModal'));
        modal.show();
        showVocabQuestion();
    }

    function showVocabQuestion() {
        const q = vocabTestState.questions[vocabTestState.currentIndex];
        const body = document.getElementById('vocabTestBody');
        const total = vocabTestState.questions.length;
        
        let optionsHtml = q.options.map(opt => `
            <button class="btn btn-outline-success w-100 mb-2 py-2 rounded-pill vocab-option" 
                    onclick="checkVocabAnswer(this, '${opt}', '${q.en}')">${opt}</button>
        `).join('');

        body.innerHTML = `
            <div class="text-center mb-4">
                <span class="badge bg-success-soft text-success mb-2">Question ${vocabTestState.currentIndex + 1}/${total}</span>
                <h3 class="fw-bold mb-0">${q.cn}</h3>
                <p class="text-muted small mt-2">è¯·é€‰æ‹©å¯¹åº”çš„è‹±æ–‡å•è¯</p>
            </div>
            <div class="vocab-options-container">
                ${optionsHtml}
            </div>
            <div id="vocabFeedback" class="text-center mt-3" style="min-height: 24px;"></div>
        `;
    }

    function checkVocabAnswer(btn, selected, correct) {
        const feedback = document.getElementById('vocabFeedback');
        const options = document.querySelectorAll('.vocab-option');
        const total = vocabTestState.questions.length;
        const pointsPerQuestion = Math.floor(100 / total);
        
        // ç¦ç”¨æ‰€æœ‰æŒ‰é’®
        options.forEach(opt => opt.disabled = true);

        if (selected === correct) {
            btn.classList.replace('btn-outline-success', 'btn-success');
            feedback.innerHTML = '<span class="text-success fw-bold">âœ¨ å¤ªæ£’äº†ï¼æ­£ç¡®ï¼</span>';
            vocabTestState.score += pointsPerQuestion;
            addScore(pointsPerQuestion, event); // ç»™æ€»åˆ†åŠ åˆ†
        } else {
            btn.classList.replace('btn-outline-success', 'btn-danger');
            feedback.innerHTML = `<span class="text-danger fw-bold">âŒ è®°é”™äº†å“¦ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯: ${correct}</span>`;
            // é«˜äº®æ­£ç¡®ç­”æ¡ˆ
            options.forEach(opt => {
                if (opt.innerText === correct) opt.classList.replace('btn-outline-success', 'btn-success');
            });
        }

        setTimeout(() => {
            vocabTestState.currentIndex++;
            if (vocabTestState.currentIndex < total) {
                showVocabQuestion();
            } else {
                showVocabResult();
            }
        }, 1500);
    }

    function showVocabResult() {
        const body = document.getElementById('vocabTestBody');
        let title = "ç»§ç»­åŠ æ²¹å“¦ï¼";
        let icon = "ğŸ“";
        if (vocabTestState.score === 100) { title = "è¯æ±‡å°è¾¾äººï¼"; icon = "ğŸ†"; }
        else if (vocabTestState.score >= 60) { title = "è¡¨ç°ä¸é”™ï¼"; icon = "â­"; }

        body.innerHTML = `
            <div class="text-center py-3">
                <div class="display-1 mb-3">${icon}</div>
                <h2 class="fw-bold text-success">${vocabTestState.score} åˆ†</h2>
                <h4 class="mb-4">${title}</h4>
                <button class="btn btn-success rounded-pill px-5" data-bs-dismiss="modal">å®Œæˆæµ‹è¯•</button>
            </div>
        `;
    }

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }
    
    function updateLeaderboard(name, points) {
        let leaderboard = JSON.parse(localStorage.getItem('pep5_leaderboard') || '[]');
        const today = new Date().toLocaleDateString();
        
        // æŸ¥æ‰¾è¯¥ç”¨æˆ·ä»Šå¤©çš„è®°å½•
        const existingIndex = leaderboard.findIndex(item => item.name === name && item.date === today);
        
        if (existingIndex !== -1) {
            // ç´¯åŠ ç§¯åˆ†
            leaderboard[existingIndex].score += points;
        } else {
            // æ–°ç”¨æˆ·æˆ–æ–°ä¸€å¤©çš„è®°å½•
            leaderboard.push({
                name: name,
                score: points,
                date: today
            });
        }
        
        // æ’åºï¼šåˆ†æ•°é™åº
        leaderboard.sort((a, b) => b.score - a.score);
        
        // åªä¿ç•™å‰15å (ç¨å¾®å¤šç•™ä¸€ç‚¹)
        leaderboard = leaderboard.slice(0, 15);
        
        localStorage.setItem('pep5_leaderboard', JSON.stringify(leaderboard));
        loadLeaderboard();
    }
    
    function loadLeaderboard() {
        const tbody = document.getElementById('leaderboard-body');
        if (!tbody) return;
        
        const leaderboard = JSON.parse(localStorage.getItem('pep5_leaderboard') || '[]');
        
        if (leaderboard.length === 0) {
            tbody.innerHTML = '<tr><td colspan="3" class="text-center py-5 text-muted">æš‚æ— è®°å½•ï¼Œå¿«å»å¼€å§‹æŒ‘æˆ˜å§ï¼</td></tr>';
            return;
        }
        
        let html = '';
        leaderboard.forEach((item, index) => {
            let rankClass = '';
            let rankIcon = '';
            
            if (index === 0) { rankClass = 'rank-1'; rankIcon = 'ğŸ¥‡ '; }
            else if (index === 1) { rankClass = 'rank-2'; rankIcon = 'ğŸ¥ˆ '; }
            else if (index === 2) { rankClass = 'rank-3'; rankIcon = 'ğŸ¥‰ '; }
            else { rankIcon = `${index + 1}. `; }
            
            html += `
                <tr class="${rankClass}">
                    <td>${rankIcon}</td>
                    <td>
                        <div class="fw-bold">${item.name}</div>
                        <small class="text-muted">${item.date}</small>
                    </td>
                    <td>${item.score} åˆ†</td>
                </tr>
            `;
        });
        
        tbody.innerHTML = html;
    }
    
    function clearLeaderboard() {
        if (confirm("ç¡®å®šè¦æ¸…ç©ºæ’è¡Œæ¦œå—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚")) {
            localStorage.removeItem('pep5_leaderboard');
            loadLeaderboard();
            showToast("æ’è¡Œæ¦œå·²é‡ç½®", "warning");
        }
    }

    function showToast(message, type = 'success') {
        const toastContainer = document.getElementById('toast-container');
        const toast = document.createElement('div');
        toast.className = `alert alert-${type} animate__animated animate__fadeInRight`;
        toast.style.marginBottom = '10px';
        toast.style.boxShadow = '0 4px 12px rgba(0,0,0,0.1)';
        toast.innerHTML = `<i class="bi bi-${type === 'success' ? 'check-circle' : 'exclamation-triangle'}-fill me-2"></i> ${message}`;
        toastContainer.appendChild(toast);
        
        setTimeout(() => {
            toast.classList.replace('animate__fadeInRight', 'animate__fadeOutRight');
            setTimeout(() => toast.remove(), 500);
        }, 3000);
    }

    const arenaData = {
        1: [
            { q: "Sarah is very ____. She always says 'hello' to teachers.", a: ["A. polite", "B. shy", "C. strict"], c: "A" },
            { q: "Our English teacher is ____. He makes us laugh.", a: ["A. old", "B. funny", "C. kind"], c: "B" },
            { q: "Is your robot ____? Yes, he is.", a: ["A. clever", "B. helpful", "C. both A and B"], c: "C" }
        ],
        2: [
            { q: "What do you have ____ Tuesdays?", a: ["A. in", "B. on", "C. at"], c: "B" },
            { q: "I often ____ my clothes on Saturdays.", a: ["A. wash", "B. watch", "C. do"], c: "A" },
            { q: "You should ____ every day.", a: ["A. play sports", "B. watch TV", "C. play football"], c: "A" }
        ],
        3: [
            { q: "What would you like ____ eat?", a: ["A. to", "B. for", "C. with"], c: "A" },
            { q: "My favourite ____ is sandwich. It's delicious.", a: ["A. drink", "B. food", "C. fruit"], c: "B" },
            { q: "I'd like some ____. I am thirsty.", a: ["A. salad", "B. water", "C. beef"], c: "B" }
        ],
        4: [
            { q: "Can you ____ some kung fu?", a: ["A. play", "B. do", "C. make"], c: "B" },
            { q: "I can play ____ pipa for the party.", a: ["A. /", "B. a", "C. the"], c: "C" },
            { q: "What ____ you do? I can dance.", a: ["A. are", "B. do", "C. can"], c: "C" }
        ],
        5: [
            { q: "There ____ a clock and two plants in my room.", a: ["A. is", "B. are", "C. be"], c: "A" },
            { q: "The ball is ____ the dog. The dog is behind it.", a: ["A. in front of", "B. behind", "C. beside"], c: "A" },
            { q: "My computer is ____ the desk.", a: ["A. in", "B. on", "C. under"], c: "B" }
        ],
        6: [
            { q: "Is there a ____ in the nature park?", a: ["A. lake", "B. trees", "C. mountains"], c: "A" },
            { q: "Are there ____ buildings in the city?", a: ["A. some", "B. any", "C. a"], c: "B" },
            { q: "There ____ many trees in the forest.", a: ["A. is", "B. are", "C. be"], c: "B" }
        ]
    };

    function startArenaQuiz(unitId) {
        const container = document.getElementById(`arena-quiz-${unitId}`);
        const questions = arenaData[unitId];
        if (!questions) return;

        let html = '<div class="mt-3">';
        questions.forEach((q, idx) => {
            html += `
                <div class="mb-4 p-3 bg-white rounded shadow-sm border-start border-warning border-4">
                    <p class="fw-bold mb-2">${idx + 1}. ${q.q}</p>
                    <div class="d-grid gap-2">
                        ${q.a.map(opt => `
                            <button class="btn btn-outline-warning text-start" onclick="checkArenaAnswer(this, '${opt[0]}', '${q.c}', ${unitId}, event)">
                                ${opt}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        });
        html += '</div>';
        container.innerHTML = html;
        showToast("æŒ‘æˆ˜å¼€å§‹ï¼åŠ æ²¹ï¼ğŸš€");
    }

    function checkArenaAnswer(btn, selected, correct, unitId, event) {
        const parent = btn.parentElement;
        const buttons = parent.querySelectorAll('button');
        buttons.forEach(b => b.disabled = true);

        if (selected === correct) {
            btn.className = 'btn btn-success text-start text-white';
            showToast("å›ç­”æ­£ç¡®ï¼ğŸ‰", "success");
            document.getElementById('audio-correct').play();
            addScore(10, event); // ç«æŠ€åœºæ­£ç¡®åŠ 10åˆ†
        } else {
            btn.className = 'btn btn-danger text-start text-white';
            buttons.forEach(b => {
                if (b.innerText.startsWith(correct)) {
                    b.className = 'btn btn-success text-start text-white';
                }
            });
            showToast("å†æ¥å†å‰å“¦ï¼ğŸ’ª", "warning");
        }
    }

    // è¯­éŸ³å¼•æ“ä¼˜åŒ–
    let preferredVoice = null;
    let voiceUnlocked = localStorage.getItem('pep5_voice_unlocked') === 'true';
    let fallbackAudio = null;
    let currentUtterance = null; // ä¿æŒå¼•ç”¨ï¼Œé˜²æ­¢å®‰å“åƒåœ¾å›æ”¶å¯¼è‡´å‘éŸ³ä¸­æ–­
    let speakTimeout = null; // ç”¨äºç®¡ç†å»¶æ—¶æœ—è¯»ï¼Œé˜²æ­¢é‡å¤
    let checkSpeakingInterval = null; // ç”¨äºå®‰å“å‡æ­»æ£€æŸ¥
    let lastSpeakId = 0; // ç”¨äºè¿½è¸ªæœ€æ–°çš„å‘éŸ³è¯·æ±‚ï¼Œé˜²æ­¢å¹¶å‘å†²çª
    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
    const isAndroid = /Android/.test(navigator.userAgent);

    // å…¨å±€ç‚¹å‡»å‘éŸ³ç›‘å¬
    document.addEventListener('click', (e) => {
        // ä»»ä½•ç‚¹å‡»éƒ½å°è¯•æ¢å¤è¯­éŸ³å¼•æ“
        if ('speechSynthesis' in window && window.speechSynthesis.paused) {
            window.speechSynthesis.resume();
        }

        // æŸ¥æ‰¾æœ€è¿‘çš„å¯å‘éŸ³å®¹å™¨
        const clickable = e.target.closest('.puzzle-item, .flashcard-back, .sentence-card .flashcard-front, .model-text, .sentence-item');
        if (clickable && !e.target.closest('.btn-speak, .full-read-btn')) {
            const btn = clickable.querySelector('.btn-speak') || clickable;
            const onclickAttr = btn.getAttribute('onclick');
            
            if (onclickAttr) {
                // æå– speak('...') ä¸­çš„å†…å®¹
                const match = onclickAttr.match(/speak\(['"](.*)['"]\)/);
                if (match && match[1]) {
                    // å¤„ç†è½¬ä¹‰å­—ç¬¦å¹¶å»é‡
                    const text = match[1].replace(/\\'/g, "'").replace(/\\"/g, '"');
                    speak(text);
                }
            } else if (clickable.classList.contains('sentence-item')) {
                // å¦‚æœæ˜¯ç›´æ¥åœ¨æ–‡æœ¬ä¸Šä¸”æ²¡æœ‰ onclick (è™½ç„¶ç›®å‰éƒ½æœ‰)ï¼Œåˆ™å–æ–‡æœ¬
                speak(clickable.innerText);
            }
        }
    });

    // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥çŠ¶æ€
    window.addEventListener('DOMContentLoaded', () => {
        if (voiceUnlocked) {
            const btn = document.getElementById('btn-unlock-audio');
            if (btn) btn.style.display = 'none';
            // å°è¯•é™é»˜æ¢å¤å¼•æ“ï¼ˆä»…å¯¹æ”¯æŒçš„æµè§ˆå™¨æœ‰æ•ˆï¼‰
            if ('speechSynthesis' in window) {
                window.speechSynthesis.resume();
                initVoices();
            }
        }
    });

    function unlockVoice() {
        const hasWebSpeech = ('speechSynthesis' in window);
        
        // 1. å¦‚æœæ”¯æŒ Web Speechï¼Œå°è¯•è§£é”
        if (hasWebSpeech) {
            window.speechSynthesis.resume();
            const msg = new SpeechSynthesisUtterance('Start');
            msg.volume = 0.1;
            msg.rate = 1.0;
            window.speechSynthesis.speak(msg);
        }
        
        // 2. è§£é” HTML5 Audio å…ƒç´  (å¯¹ Fallback æ¨¡å¼è‡³å…³é‡è¦)
        ['audio-correct', 'audio-clapping'].forEach(id => {
            const audio = document.getElementById(id);
            if (audio) {
                audio.play().then(() => {
                    audio.pause();
                    audio.currentTime = 0;
                }).catch(e => console.log("Audio unlock failed", e));
            }
        });
        
        voiceUnlocked = true;
        localStorage.setItem('pep5_voice_unlocked', 'true');
        
        if (hasWebSpeech) initVoices();
        
        // æ›´æ–°æŒ‰é’®çŠ¶æ€
        const btn = document.getElementById('btn-unlock-audio');
        if (btn) {
            btn.innerHTML = hasWebSpeech ? 'âœ¨ è¯­éŸ³åˆå§‹åŒ–ä¸­...' : 'âœ¨ å…¼å®¹æ¨¡å¼å¼€å¯ä¸­...';
            btn.classList.replace('btn-light', 'btn-warning');
            
            setTimeout(() => {
                btn.innerHTML = 'âœ… è¯­éŸ³å·²å¼€å¯';
                btn.classList.replace('btn-warning', 'btn-success');
                speak('Ready!');
                setTimeout(() => btn.style.display = 'none', 1500);
            }, 800);
        }
    }

    function initVoices() {
        if (!('speechSynthesis' in window)) return;
        
        let voices = window.speechSynthesis.getVoices();
        
        const trySelectVoice = () => {
            if (voices.length > 0) {
                preferredVoice = voices.find(v => (v.name === 'Google US English' || v.name === 'English (United States)') && v.lang.startsWith('en')) ||
                                 voices.find(v => v.name.includes('Samantha') && v.lang.startsWith('en')) ||
                                 voices.find(v => v.lang.startsWith('en-US')) ||
                                 voices.find(v => v.lang.startsWith('en'));
            }
        };

        if (voices.length === 0) {
            window.speechSynthesis.onvoiceschanged = () => {
                voices = window.speechSynthesis.getVoices();
                trySelectVoice();
            };
            setTimeout(() => {
                if (!preferredVoice) {
                    voices = window.speechSynthesis.getVoices();
                    trySelectVoice();
                }
            }, 500);
        } else {
            trySelectVoice();
        }
    }

    if ('speechSynthesis' in window) {
        initVoices();
    }

    function speak(text) {
        if (!text) return;
        console.log("TTS Request:", text);
        
        // 1. å°è¯•è‡ªåŠ¨æ¢å¤è¯­éŸ³å¼•æ“ (è§£å†³éƒ¨åˆ†æµè§ˆå™¨é™é»˜çŠ¶æ€ä¸‹æ— æ³•å‘éŸ³çš„é—®é¢˜)
        if ('speechSynthesis' in window) {
            if (window.speechSynthesis.paused) {
                console.log("Resuming stalled speechSynthesis");
                window.speechSynthesis.resume();
            }
        }

        // å¦‚æœæœªè§£é”ï¼Œå°è¯•è‡ªåŠ¨è§£é”ï¼ˆç”±ç”¨æˆ·ç‚¹å‡»è§¦å‘ï¼‰
        if (!voiceUnlocked) {
            unlockVoice();
        }
        
        // 2. å½»åº•æ¸…ç†ä¹‹å‰çš„å¾…æ‰§è¡Œä»»åŠ¡
        if (speakTimeout) {
            clearTimeout(speakTimeout);
            speakTimeout = null;
        }
        
        if (checkSpeakingInterval) {
            clearInterval(checkSpeakingInterval);
            checkSpeakingInterval = null;
        }

        // åœæ­¢ä¹‹å‰çš„ Fallback éŸ³é¢‘
        if (fallbackAudio) {
            try {
                fallbackAudio.pause();
                fallbackAudio.currentTime = 0;
            } catch (e) {}
            fallbackAudio = null;
        }

        // 3. ç”Ÿæˆæ–°çš„è¯·æ±‚ ID
        const currentId = ++lastSpeakId;

        // æ¸…ç†æ–‡æœ¬
        const cleanText = text.replace(/\s+/g, ' ').trim();

        if ('speechSynthesis' in window) {
            // 4. ç«‹å³åœæ­¢å½“å‰å‘éŸ³
            try {
                window.speechSynthesis.cancel();
            } catch (e) {}

            // é’ˆå¯¹ä¸åŒå¹³å°è®¾ç½®ä¸åŒçš„æ‰§è¡Œç­–ç•¥
            // iOS å’Œ Desktop å¿…é¡»ç«‹å³æ‰§è¡Œä»¥ä¿ç•™ç”¨æˆ·æ‰‹åŠ¿ä¸Šä¸‹æ–‡
            if (!isAndroid) {
                executeSpeak(cleanText, currentId);
            } else {
                // å®‰å“é€šå¸¸éœ€è¦ä¸€ç‚¹å»¶è¿Ÿæ¥ç¡®ä¿ cancel() å®Œæˆ
                speakTimeout = setTimeout(() => {
                    if (currentId === lastSpeakId) {
                        executeSpeak(cleanText, currentId);
                    }
                    speakTimeout = null;
                }, 250);
            }
        } else {
            speakFallback(cleanText, currentId);
        }
    }

    function showUnlockButton() {
        const btn = document.getElementById('btn-unlock-audio');
        if (btn) {
            btn.style.display = 'block';
            btn.classList.add('animate__shakeX');
            setTimeout(() => btn.classList.remove('animate__shakeX'), 1000);
        }
    }

    function executeSpeak(text, requestId) {
        console.log("Executing WebSpeech:", text, "RequestID:", requestId);
        try {
            // 1. åˆ›å»ºæ–°çš„ Utterance
            const utterance = new SpeechSynthesisUtterance();
            currentUtterance = utterance;
            utterance.text = text;
            utterance.lang = 'en-US';
            utterance.rate = 0.85;
            utterance.pitch = 1.0;
            utterance.volume = 1.0;
            
            // 2. é€‰æ‹©è¯­éŸ³
            if (!preferredVoice) initVoices();
            if (preferredVoice) utterance.voice = preferredVoice;

            // 3. æ ¸å¿ƒäº‹ä»¶ç›‘å¬
            utterance.onstart = () => {
                console.log("WebSpeech started:", requestId);
                if (requestId !== lastSpeakId) return;
                if (window.speechSynthesis.paused) {
                    window.speechSynthesis.resume();
                }
            };

            utterance.onend = () => {
                console.log("WebSpeech ended:", requestId);
                if (requestId !== lastSpeakId) return;
                currentUtterance = null;
                if (checkSpeakingInterval) {
                    clearInterval(checkSpeakingInterval);
                    checkSpeakingInterval = null;
                }
            };

            utterance.onerror = (e) => {
                console.error("WebSpeech Error:", e, "RequestID:", requestId);
                if (requestId !== lastSpeakId) return;
                currentUtterance = null;
                if (checkSpeakingInterval) {
                    clearInterval(checkSpeakingInterval);
                    checkSpeakingInterval = null;
                }
                
                // æ ¸å¿ƒä¿®å¤ï¼šåªæœ‰éäººä¸ºä¸­æ–­çš„é”™è¯¯æ‰è§¦å‘ Fallback
                if (e.error !== 'interrupted' && e.error !== 'canceled') {
                    // å¦‚æœæ˜¯å…¶ä»–é”™è¯¯ï¼ˆå¦‚ç½‘ç»œé—®é¢˜ã€å¼•æ“æ•…éšœï¼‰ï¼Œå°è¯• Fallback
                    speakFallback(text, requestId);
                }
            };
            
            // 4. æ‰§è¡Œæœ—è¯»
            if (window.speechSynthesis.paused) {
                window.speechSynthesis.resume();
            }
            window.speechSynthesis.speak(currentUtterance);
            
            // ç›‘æ§ï¼šå¦‚æœ 2 ç§’åè¿˜æ²¡å¼€å§‹ï¼Œå¼ºåˆ¶ resume ä¸€æ¬¡
            setTimeout(() => {
                if (requestId === lastSpeakId && currentUtterance && !window.speechSynthesis.speaking) {
                    console.log("Stuck detected, forcing resume...");
                    window.speechSynthesis.resume();
                }
            }, 2000);

            // 5. å®‰å“ Hack: å®šæ—¶æ£€æŸ¥æ˜¯å¦å¤„äºâ€œå‡æ­»â€çŠ¶æ€
            if (isAndroid) {
                checkSpeakingInterval = setInterval(() => {
                    // å¦‚æœè¯·æ±‚ ID å·²å˜ï¼Œè¯´æ˜æœ‰æ–°ä»»åŠ¡ï¼Œç«‹å³é€€å‡º
                    if (requestId !== lastSpeakId) {
                        clearInterval(checkSpeakingInterval);
                        return;
                    }
                    if (window.speechSynthesis.speaking) {
                        if (window.speechSynthesis.paused) {
                            window.speechSynthesis.resume();
                        }
                    } else {
                        clearInterval(checkSpeakingInterval);
                        checkSpeakingInterval = null;
                    }
                }, 2000);
            }

        } catch (e) {
            console.error("Execute speak failed:", e);
            currentUtterance = null;
            speakFallback(text, requestId);
        }
    }

    function speakFallback(text, requestId) {
        if (!text) return;
        console.log("Using Fallback TTS:", text, "RequestID:", requestId);
        
        // å¦‚æœè¯·æ±‚ ID ä¸æ˜¯æœ€æ–°çš„ï¼Œæ”¾å¼ƒæ’­æ”¾
        if (requestId !== undefined && requestId !== lastSpeakId) return;

        if (fallbackAudio) {
            try {
                fallbackAudio.pause();
                fallbackAudio.currentTime = 0;
            } catch (e) {}
            fallbackAudio = null;
        }
        
        const url = `https://dict.youdao.com/dictvoice?audio=${encodeURIComponent(text)}&type=2`;
        
        try {
            fallbackAudio = new Audio(url);
            const playPromise = fallbackAudio.play();
            
            if (playPromise !== undefined) {
                playPromise.catch(e => {
                    console.error("Fallback TTS failed:", e);
                    // å¦‚æœè‡ªåŠ¨è§£é”å¤±è´¥ï¼Œæ‰æ˜¾ç¤ºæŒ‰é’®
                    if (!voiceUnlocked) showUnlockButton();
                });
            }
        } catch (e) {
            console.error("Fallback creation failed:", e);
        }
    }

    const phonicsQuizState = {};

    function startPhonicsQuiz(unitId, words) {
        phonicsQuizState[unitId] = {
            words: words,
            currentStep: 0,
            correctCount: 0,
            targetWords: []
        };
        
        // éšæœºé€‰3ä¸ªä¸é‡å¤çš„è¯
        const shuffled = [...words].sort(() => 0.5 - Math.random());
        phonicsQuizState[unitId].targetWords = shuffled.slice(0, 3);
        
        showPhonicsStep(unitId);
    }

    function showPhonicsStep(unitId) {
        const state = phonicsQuizState[unitId];
        const container = document.getElementById('phonics-options-' + unitId);
        const quizContainer = document.getElementById('phonics-quiz-container-' + unitId);
        
        if (state.currentStep >= 3) {
            quizContainer.innerHTML = `<div class="alert alert-success py-2 mb-0 animate__animated animate__fadeIn">å®ŒæˆæŒ‘æˆ˜ï¼æ­£ç¡®ç‡: ${state.correctCount}/3 ğŸŒŸ</div>`;
            container.style.display = 'none';
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
            return;
        }

        const targetWord = state.targetWords[state.currentStep];
        quizContainer.innerHTML = `<span class="badge bg-info text-dark me-2">ç¬¬ ${state.currentStep + 1} é¢˜</span> æ­£åœ¨æ’­æ”¾ï¼Œè¯·ä»”ç»†å¬...`;
        container.innerHTML = '';
        container.style.display = 'block';

        setTimeout(() => {
            speak(targetWord);
            
            // ç”Ÿæˆé€‰é¡¹ï¼ˆåŒ…å«æ­£ç¡®é€‰é¡¹å’Œå¹²æ‰°é¡¹ï¼‰
            const options = [...state.words].sort(() => 0.5 - Math.random()).slice(0, 4);
            if (!options.includes(targetWord)) {
                options[0] = targetWord;
            }
            options.sort(() => 0.5 - Math.random());

            options.forEach(word => {
                const btn = document.createElement('button');
                btn.className = 'phonics-btn animate__animated animate__bounceIn';
                btn.innerText = word;
                btn.onclick = (event) => {
                    const buttons = container.querySelectorAll('.phonics-btn');
                    buttons.forEach(b => b.disabled = true);
                    
                    if (word === targetWord) {
                        btn.style.background = '#C8E6C9';
                        btn.innerText = 'âœ… ' + word;
                        state.correctCount++;
                        document.getElementById('audio-correct').play();
                        addScore(5, event); // è¯­éŸ³æŒ‘æˆ˜æ¯é¢˜5åˆ†
                    } else {
                        btn.style.background = '#FFCDD2';
                        btn.innerText = 'âŒ ' + word;
                        // é«˜äº®æ­£ç¡®ç­”æ¡ˆ
                        buttons.forEach(b => {
                            if (b.innerText === targetWord) b.style.background = '#C8E6C9';
                        });
                    }
                    
                    setTimeout(() => {
                        state.currentStep++;
                        showPhonicsStep(unitId);
                    }, 1500);
                };
                container.appendChild(btn);
            });
        }, 500);
    }

    function checkAnswer(btn, selected, correct, unitId, totalQuiz, event) {
        const parent = btn.parentElement;
        const buttons = parent.querySelectorAll('.option-btn');
        
        buttons.forEach(b => {
            b.disabled = true;
            if (b.innerText.startsWith(correct)) {
                b.classList.add('correct');
            }
        });

        if (!unitProgress[unitId]) unitProgress[unitId] = 0;

        if (selected === correct) {
            btn.classList.add('correct');
            unitProgress[unitId]++;
            addScore(5, event); // æ™®é€šç»ƒä¹ æ¯é¢˜5åˆ†
            
            // æ’­æ”¾éŸ³æ•ˆ
            document.getElementById('audio-correct').play();
            
            // é¼“åŠ±å¼¹çª—
            const pop = document.getElementById('feedback-pop');
            const word = encouragingWords[Math.floor(Math.random() * encouragingWords.length)];
            pop.innerText = word;
            pop.style.display = 'block';
            pop.className = 'feedback-pop animate__animated animate__zoomInUp text-success';
            
            setTimeout(() => {
                pop.style.display = 'none';
            }, 1000);

            showFeedback(parent, "âœ… " + word, "text-success");

            // æ£€æŸ¥å•å…ƒæ˜¯å¦å®Œæˆ
            if (unitProgress[unitId] === totalQuiz) {
                setTimeout(() => {
                    triggerFireworks();
                    document.getElementById('audio-clapping').play();
                    showToast("æ­å–œä½ å®Œæˆäº†å…¨éƒ¨ç»ƒä¹ ï¼å¤ªæ£’äº†ï¼ğŸ‘", "success");
                }, 500);
            }
        } else {
            btn.classList.add('wrong');
            showFeedback(parent, "âŒ åˆ«ç°å¿ƒï¼Œå†è®°ä¸€ä¸‹è€ƒç‚¹å“¦ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯ " + correct, "text-danger");
        }
    }

    function showFeedback(parent, msg, colorClass) {
        const feedback = parent.nextElementSibling;
        feedback.innerText = msg;
        feedback.className = "feedback mt-2 fw-bold " + colorClass;
        feedback.style.display = "block";
    }

    function toggleModel(unitId) {
        const model = document.getElementById('model-' + unitId);
        model.style.display = model.style.display === 'none' ? 'block' : 'none';
    }

    function addToPuzzle(item, unitId) {
        const box = document.getElementById('box-' + unitId);
        if (!item.classList.contains('used')) {
            const newItem = document.createElement('div');
            newItem.className = 'puzzle-item animate__animated animate__fadeIn';
            newItem.innerText = item.innerText;
            box.appendChild(newItem);
            item.classList.add('used');
            
            // ç®€å•çš„å®Œæˆåé¦ˆ
            const total = document.getElementById('pool-' + unitId).querySelectorAll('.puzzle-item').length;
            const used = document.getElementById('pool-' + unitId).querySelectorAll('.puzzle-item.used').length;
            if (total === used) {
                confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
            }
        }
    }

    function resetPuzzle(unitId) {
        document.getElementById('box-' + unitId).innerHTML = '';
        document.getElementById('pool-' + unitId).querySelectorAll('.puzzle-item').forEach(i => i.classList.remove('used'));
    }

    function triggerFireworks() {
        var duration = 3 * 1000;
        var animationEnd = Date.now() + duration;
        var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 3000 };

        function randomInRange(min, max) {
            return Math.random() * (max - min) + min;
        }

        var interval = setInterval(function() {
            var timeLeft = animationEnd - Date.now();

            if (timeLeft <= 0) {
                return clearInterval(interval);
            }

            var particleCount = 50 * (timeLeft / duration);
            confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
            confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
        }, 250);
    }
</script>

</body>
</html>
